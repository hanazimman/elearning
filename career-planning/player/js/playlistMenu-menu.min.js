(window.webpackJsonp=window.webpackJsonp||[]).push([[70],{1309:function(e,t,n){"use strict";const{registerMenu:s,registerReducer:r}=n(4),i=n(2179),o=n(2180);r("playlistMenu",i),s("playlistMenu",o,{shouldFilterChildren:!1,shouldRerenderOnMenuChanged:!1})},1391:function(e,t,n){"use strict";e.exports=function(e){var t;const n=e.displayTitle,s=null!==(t=e._heroImage)&&void 0!==t&&t._isEnabled?e._heroImage.title:null;return n||s}},1598:function(e,t,n){"use strict";t.GROUP_CATEGORY_CHANGED="GROUP_CATEGORY_CHANGED",t.CATEGORY_CHANGED="CATEGORY_CHANGED",t.RESET_CATEGORIES="RESET_CATEGORIES",t.groupCategoryChanged=(e,n)=>({type:t.GROUP_CATEGORY_CHANGED,payload:{groupId:e,categoryId:n}}),t.categoryChanged=e=>({type:t.CATEGORY_CHANGED,payload:{categoryId:e}}),t.resetCategories=()=>({type:t.RESET_CATEGORIES})},2179:function(e,t,n){"use strict";const s=n(99),r=n(139),i=n(34),o=n(43),a=n(94),{SETUP_APP:l}=n(9),{CATEGORY_CHANGED:u,GROUP_CATEGORY_CHANGED:c,RESET_CATEGORIES:d}=n(1598),p={selectedCategory:"all",categories:{},groups:{}};e.exports=(e=p,t)=>{switch(t.type){case l:return function(e,{course:t,settings:n}){if("playlistMenu"!==n._menu)return e;const s=r(t._categories,"_id"),l=i(t._categoryGroups).map(e=>({...e,categories:o(s,e._categories),selectedCategory:"all"})).keyBy("_id").value(),u=i(t._categoryGroups).map(e=>e._categories).flatten().value(),c=a(s,u);return{...p,groups:l,categories:c}}(e,t.payload);case u:return{...e,selectedCategory:t.payload.categoryId};case c:return{...e,groups:{...e.groups,[t.payload.groupId]:{...e.groups[t.payload.groupId],selectedCategory:t.payload.categoryId}}};case d:return{...e,selectedCategory:"all",groups:s(e.groups,e=>({...e,selectedCategory:"all"}))};default:return e}}},2180:function(e,t,n){"use strict";const s=n(171),r=n(142),i=n(31),o=n(43),a=n(141),l=n(28),u=n(8),c=n(2),d=n(1),p=n(0),{connect:m}=n(6),h=n(7),{setAriaLive:g}=n(58),y=n(62),v=n(478),C=n(143),_=n(322),E=n(231),b=n(40),{categoryChanged:I,groupCategoryChanged:R,resetCategories:M}=n(1598),T=n(2181),f=n(2182),N=n(2183),S=n(2184),A=n(2185),k=c({displayName:"PlaylistMenu",propTypes:{course:d.object.isRequired,menu:d.object.isRequired,device:d.object.isRequired,theme:d.object.isRequired,items:d.object.isRequired,location:d.object.isRequired,categories:d.object.isRequired,groups:d.object.isRequired,selectedCategory:d.string.isRequired,categoryChanged:d.func.isRequired,groupCategoryChanged:d.func.isRequired,resetCategories:d.func.isRequired,setAriaLive:d.func.isRequired,hasActionBar:d.bool.isRequired,isShowingHiddenContent:d.bool,history:d.object.isRequired,classList:d.array},getInitialState:()=>({_selectedItemId:null}),componentDidMount(){this.announceMenuAriaLabel()},componentDidUpdate({menu:e}){e._id!==this.props.menu._id&&this.announceMenuAriaLabel()},announceMenuAriaLabel(){this.props.menu.ariaLabel&&this.props.setAriaLive({message:this.props.menu.ariaLabel,delay:200})},getSelectedCategoriesMap(){const{props:e}=this,t=s(e.groups,(e,t)=>("all"!==t.selectedCategory&&(e[t.selectedCategory]=!0),e),{});return"all"!==e.selectedCategory&&(t[e.selectedCategory]=!0),t},getMenuItems(){const{props:e}=this,t=this.getSelectedCategoriesMap(),n=e.menu._id!==e.course._id?e.menu._id:null,s=r(t),l=i(e.items,i=>!(i._isHidden&&!e.isShowingHiddenContent)&&("page"===i._type&&((!n||i._parentId===n)&&(!s||r(o(t,i._categories))===s))));return a(l,"_contentObjectOrder")},getAvailableMenus(){return i(this.props.items,e=>"menu"===e._type)},getClassName(){const{classList:e,theme:t}=this.props;return h("ev-playlist-menu ev-menu",e,{"ev-use-menu-header-styles":t._menu._settings._useMenuHeaderStyles,"ev-disable-inner-flex":t._footer._settings._isStickyFooterDisabled})},getIsMenuReady(){const{menu:e,location:t}=this.props;return!(!e._isReady||!t.isLocationReady)},onResetCategories(e){e.preventDefault(),e.currentTarget.blur();const{props:t}=this;t.resetCategories(),t.history.replace("/menu/"+t.course._id)},onCategoryChanged(e){this.props.categoryChanged(e)},onGroupCategoryChanged(e,t){this.props.groupCategoryChanged(e,t)},onMenuChanged(e){const{props:t}=this,n="all"===e?t.course._id:e;t.history.push("/menu/"+n)},onShowItemContent(e){this.setState({_selectedItemId:e})},renderGroupFilters(){return r(this.props.groups)?l(this.props.groups,e=>p.createElement(f,{key:e._id,group:e,allText:u(this.props.course,"_playlistMenu.allText","All"),onChange:this.onGroupCategoryChanged})):null},renderMenuSelect(e){if(!e.length)return;const{props:t}=this;return p.createElement(N,{items:e,value:t.menu._id===t.course._id?"all":t.menu._id,allText:u(this.props.course,"_playlistMenu.allText","All"),onChange:this.onMenuChanged})},renderFullPlaylistButton(e){if(!e)return;const{props:t}=this;return p.createElement("button",{onClick:this.onResetCategories,className:"ev-category-button ev-button ev-primary"},u(t.course,"_playlistMenu._fullPlaylist"))},renderFilters(){const e=this.renderGroupFilters(),t=this.getAvailableMenus(),n=this.renderMenuSelect(t);if(!e&&!n)return;const s=this.renderFullPlaylistButton(!r(this.props.categories)&&(e||n));return p.createElement("div",{className:"ev-categories-action-bar-items"},e,n,s)},renderCategoryButtons(){return r(this.props.categories)?p.createElement("div",{className:"ev-categories-action-bar-items"},l(this.props.categories,e=>p.createElement(S,{key:e._id,category:e,isSelected:this.props.selectedCategory===e._id,onClick:this.onCategoryChanged})),this.renderFullPlaylistButton(!0)):null},renderActionBar(){const e=this.renderFilters(),t=this.renderCategoryButtons();if(e||t)return p.createElement("div",{className:"ev-categories-action-bar ev-action-bar"},p.createElement("div",{className:"ev-action-bar-inner"},e,t))},getShouldShowProgressBars(){const{props:e}=this,t=u(e.theme,"_menu._settings._shouldShowProgressBarsOnMenus","content"),n=u(e.menu,"_playlistMenu._shouldShowProgressBarsOnMenus",!0);return"content"===t?n:"true"===t},renderItems(){const{props:e,state:t}=this,n=this.getMenuItems(),s=u(e.theme,"_menu._settings._durationIcon",null);return l(n,n=>p.createElement(A,{key:n._id,itemId:n._id,device:e.device,durationIcon:s,shouldShowProgressBarsOnMenus:this.getShouldShowProgressBars(),isContentVisible:t._selectedItemId===n._id,onShowItemContent:this.onShowItemContent}))},renderElements(e){return y("menu",e,{menu:this.props.menu})},renderHeroImage(e){const{_heroImage:t}=this.props.menu._playlistMenu;if(t)return p.createElement(b.Provider,{value:this.props.menu.displayTitle?this.context+1:this.context},p.createElement(E,{title:t.title,body:t.body,graphic:t._graphic,_contentWidth:t._contentWidth,layout:t.layout,floatingGraphic:t._floatingGraphic,parentSelector:".ev-menu-container-inner",contentObjectType:"menu",theme:this.props.theme,isReady:e}))},render(){var e;const{props:t}=this,n=C(),s=this.getIsMenuReady(),r=t.menu.displayTitle||null!==(e=t.menu._playlistMenu._heroImage)&&void 0!==e&&e.title?this.context+1:this.context;return p.createElement("div",{className:this.getClassName()},p.createElement(_,{backgroundImage:t.menu._playlistMenu._desktopBackgroundImage,mobileBackgroundImage:t.menu._playlistMenu._mobileBackgroundImage}),v(t.menu),p.createElement("main",{className:"ev-menu-container",style:{minHeight:`calc(100vh - ${n})`}},p.createElement("div",{className:"ev-menu-root"},this.renderElements("root")),p.createElement("div",{className:"ev-menu-container-inner"},this.renderHeroImage(s),p.createElement(T,{menu:t.menu,hasActionBar:this.props.hasActionBar}),p.createElement(b.Provider,{value:r},p.createElement("div",{className:"ev-action-bar-container"},this.renderElements("actionBar")),this.renderActionBar(),p.createElement("div",{className:"ev-menu-items"},p.createElement("div",{className:"ev-menu-items-inner ev-clearfix"},this.renderItems())))),p.createElement("div",{className:"ev-menu-footer"},this.renderElements("footer"))))}});k.contextType=b,e.exports=m(e=>({...e.playlistMenu,items:e.contentObjects}),{setAriaLive:g,categoryChanged:I,groupCategoryChanged:R,resetCategories:M})(k)},2181:function(e,t,n){"use strict";const s=n(2),r=n(1),i=n(0),o=n(219),a=n(168),l=n(316),u=n(7),c=n(30),d=n(76),p=n(40),m=s({displayName:"PlaylistMenuHeader",propTypes:{menu:r.object.isRequired,hasActionBar:r.bool.isRequired},renderTitle(){if(this.props.menu.displayTitle)return i.createElement(d,{headingElement:"h"+this.context,displayTitle:this.props.menu.displayTitle,displayTitleSettings:this.props.menu._displayTitleSettings,className:"ev-menu-title ev-header-title",innerClassName:"ev-menu-title-inner ev-header-title-inner"})},renderBody(){if(this.props.menu.body)return i.createElement(c,{className:"ev-menu-body ev-header-body",innerClassName:"ev-menu-body-inner ev-header-body-inner",hasInner:!0,body:this.props.menu.body})},getStyle(e){const t=e._playlistMenu._backgroundImage;if(!a(t))return l(!0);const{src:n,srcAdvanced:s}=t;return{backgroundImage:`url("${o(n,s,!0)}")`,minHeight:"350px"}},render(){const{menu:e}=this.props;return e.displayTitle||e.body?i.createElement("div",{className:u("ev-menu-header ev-header",{"ev-header-with-action-bar":this.props.hasActionBar}),style:this.getStyle(e)},i.createElement("div",{className:"ev-menu-header-inner ev-header-inner ev-clearfix ev-no-graphic"},i.createElement("div",{className:"ev-menu-header-content ev-header-left"},this.renderTitle(),this.renderBody()))):null}});m.contextType=p,e.exports=m},2182:function(e,t,n){"use strict";const s=n(28),r=n(2),i=n(1),o=n(0),a=r({displayName:"PlaylistGroupSelect",propTypes:{allText:i.string.isRequired,group:i.shape({_id:i.string.isRequired,name:i.string.isRequired,categories:i.object.isRequired,selectedCategory:i.string}).isRequired,onChange:i.func.isRequired},render(){const{allText:e,group:t,onChange:n}=this.props;return o.createElement("div",{className:"ev-playlist-group-select"},o.createElement("label",null,t.name,o.createElement("select",{id:t._id,value:t.selectedCategory,onChange:({target:e})=>n(t._id,e.value)},o.createElement("option",{value:"all"},e),s(t.categories,({_id:e,name:t})=>o.createElement("option",{value:e,key:e},t)))))}});e.exports=a},2183:function(e,t,n){"use strict";const s=n(28),r=n(2),i=n(1),o=n(0),a=r({displayName:"PlaylistMenuSelect",propTypes:{label:i.string,allText:i.string.isRequired,items:i.array.isRequired,onChange:i.func.isRequired,value:i.string.isRequired},getDefaultProps:()=>({label:"Topic"}),render(){return o.createElement("div",{className:"ev-playlist-group-select"},o.createElement("label",null,this.props.label,o.createElement("select",{value:this.props.value,onChange:({target:e})=>this.props.onChange(e.value),id:"ev-playlist-menu-select"},o.createElement("option",{value:"all",key:"all"},this.props.allText),s(this.props.items,e=>{const t=e._playlistMenu?e._playlistMenu._menuDropdownTitle:null;return o.createElement("option",{key:e._id,value:e._id},t||e.title)}))))}});e.exports=a},2184:function(e,t,n){"use strict";const s=n(2),r=n(1),i=n(0),o=n(7),a=s({displayName:"PlaylistCategoryButton",propTypes:{category:r.object.isRequired,onClick:r.func.isRequired,isSelected:r.bool},onClick(e){e.preventDefault(),e.currentTarget.blur(),this.props.onClick(this.props.category._id)},render(){return i.createElement("button",{className:o("ev-category-button ev-button ev-primary",{"ev-is-selected":this.props.isSelected}),onClick:this.onClick},this.props.category.name)}});e.exports=a},2185:function(e,t,n){"use strict";const s=n(2),r=n(1),i=n(0),o=n(55),a=n(7),l=n(1391),u=n(478),c=n(62),d=n(76),p=n(30),{MenuItemProgress:m,MenuItemHOC:h,MenuItemDuration:g,MenuItemLink:y}=n(301),v=n(219),C=n(168),_=n(63),E=n(40),b=s({displayName:"PlaylistMenuItem",propTypes:{item:r.object.isRequired,device:r.object.isRequired,durationIcon:r.string,shouldShowProgressBarsOnMenus:r.bool,isContentVisible:r.bool.isRequired,isVisibleItem:r.bool,pageMenuItemsCount:r.number,pageMenuItemsCompletedCount:r.number,completedChildrenAsPercentage:r.number},getInitialState:()=>({_height:window.innerHeight}),componentDidMount(){this.updateSizes()},UNSAFE_componentWillReceiveProps({device:e}){e!==this.props.device&&this.updateSizes()},updateSizes(){const e=o.findDOMNode(this).offsetWidth;this.setState({_height:e})},onClick(e){const{item:t}=this.props;t._isLocked&&e.preventDefault()},renderTitle(){const e=l(this.props.item);if(e)return i.createElement(d,{id:this.props.item._id+"-title",headingElement:"h"+this.context,displayTitle:e,className:"ev-menu-item-title",innerClassName:"ev-menu-item-title-inner"})},renderBody(){if(this.props.item.description)return i.createElement(p,{body:this.props.item.description,className:"ev-menu-item-body",innerClassName:"ev-menu-item-body-inner"})},renderDuration(){const{duration:e,durationLabel:t}=this.props.item;if(e)return i.createElement(g,{duration:e,durationIcon:this.props.durationIcon,durationLabel:t})},renderProgress(){const{props:e}=this;if(null!=e&&e.shouldShowProgressBarsOnMenus)return i.createElement(m,{item:e.item,pageMenuItemsCompletedCount:e.pageMenuItemsCompletedCount,pageMenuItemsCount:e.pageMenuItemsCount,completedChildrenAsPercentage:e.completedChildrenAsPercentage})},renderLink(){const{item:e}=this.props;return i.createElement(y,{isLocked:e._isLocked,isVisited:e._isVisited,linkText:e.linkText,linkIcon:e.linkIcon,isLinkIconRightPosition:e.isLinkIconRightPosition,link:`/${e._type}/${e._id}`})},getStyle(){var e,t;const n={height:this.state._height+"px"},s=null===(e=this.props.item)||void 0===e||null===(t=e._playlistMenu)||void 0===t?void 0:t._graphic;return C(s)?(n.backgroundImage=`url("${v(s.src,s.srcAdvanced,!0)}")`,n):n},getItemClass(){return a("ev-menu-item ev-collection-item","ev-menu-item-"+this.props.item._id,{"ev-is-visible-item":this.props.isVisibleItem,"ev-is-content-visible":this.props.isContentVisible})},renderElements(e){return c("menuItem",e,{item:this.props.item})},render(){return i.createElement(_,{id:this.props.item._id,name:"menu item",className:this.getItemClass(),style:this.getStyle()},this.renderElements("root"),u(this.props.item,"menuitem"),i.createElement("div",{className:"ev-menu-item-inner ev-collection-item-inner"},i.createElement("div",{className:"ev-collection-item-content"},i.createElement("div",{className:"ev-collection-item-content-inner ev-clearfix"},this.renderTitle(),i.createElement("div",{className:"ev-menu-item-hidden-content"},this.renderBody(),this.renderDuration(),this.renderElements("content"),this.renderProgress(),this.renderLink())))))}});b.contextType=E,e.exports=h(b)}}]);
(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{1317:function(e,t,o){"use strict";const{registerReducer:n,registerEpics:r}=o(4),i=o(1380),a=o(2213),{bookShelfSetupEpic:s,registerTrackingMapEpic:l,saveTrackingEpic:c}=o(2214);n("bookShelf",a),r(s,l,c,i("bookShelf"))},1380:function(e,t,o){"use strict";const n=o(8),{Observable:r}=o(5),{setLocationReadyState:i,PUSH_LOCATION:a}=o(9),s=o(219),l=o(217);e.exports=(e,t)=>(o,c)=>o.filter(({type:t})=>{if(t!==a)return;const{navigationStatus:o,path:n}=c.getState().location;return"plugin"===o&&n[0]===e}).switchMap(()=>{const o=c.getState(),{device:a,course:d}=o;let h;if(h=t?t(o):n(d,["_"+e,"_heroImage"]),!h||!h._graphic)return r.empty();const p=s(h._graphic.src,h._graphic.srcAdvanced,!0);return p?r.concat(r.of(i(!1)),r.bindCallback(l)(p,!1).map(()=>i(!0))):r.empty()})},1383:function(e,t,o){"use strict";const n=o(8),{store:r}=o(4);e.exports=function(e,t,o){const{course:i,theme:a}=r.getState(),s=i[e],l=n(s,t),c=n(a,["_extensions",e,"_settings",t]);return l||c||o}},1401:function(e,t,o){"use strict";t.TRACKER_LOAD_DATA="TRACKER_LOAD_DATA",t.TRACKER_SAVE_SESSION="TRACKER_SAVE_SESSION",t.SET_TRACKER_AUTH="SET_TRACKER_AUTH",t.SAVE_TRACKER_DONE="SAVE_TRACKER_DONE",t.trackerLoadData=e=>({type:t.TRACKER_LOAD_DATA,payload:e}),t.trackerSaveSession=e=>({type:t.TRACKER_SAVE_SESSION,payload:e}),t.setTrackerAuth=e=>({type:t.SET_TRACKER_AUTH,payload:e}),t.saveTrackingDone=e=>({type:t.SAVE_TRACKER_DONE,payload:e})},2213:function(e,t,o){"use strict";const n=o(11),{SETUP_APP:r}=o(9),i={_isEnabled:!1};e.exports=(e=i,t)=>{if(t.type===r){const o=t.payload.course._bookShelf;return o&&o._isEnabled?n({},e,o):i}return e._isEnabled?(t.type,e):i}},2214:function(e,t,o){"use strict";const n=o(8),{Observable:r}=o(5),{registerTrackingMap:i}=o(4),{SETUP_APP:a}=o(9),{addElement:s}=o(42),{NavigationSideItem:l}=o(475),c=o(1383),{UPDATE_ARTICLE:d}=o(78),{trackerSaveSession:h}=o(1401),p=o(2215),u=o(2216),b=o(2217);t.bookShelfSetupEpic=(e,t)=>e.filter(e=>{var o;const n=t.getState();return e.type===a&&(null==n||null===(o=n.bookShelf)||void 0===o?void 0:o._isEnabled)}).mergeMap(()=>{const e=t.getState(),{bookShelf:o}=e,i=s({parent:"navigationSide",name:"bookShelf",component:l,props:{link:"/bookShelf",icon:c("_bookShelf","_navigationIcon","bookmark"),label:o.title}}),a=s({parent:"article",name:"bookShelf",component:p,position:"actionBar",props:{ariaLabel:o.shelveButtonAriaLabel}}),d=s({parent:"router",name:"bookShelf",path:"/bookShelf",exact:!0,component:u,getShouldPersist:e=>n(e,"course._bookShelf._isEnabled",!1)});return r.of(i,a,d)}),t.registerTrackingMapEpic=(e,t)=>e.filter(e=>{if(e.type!==a)return!1;const{bookShelf:o}=t.getState();return o&&o._isEnabled}).do(()=>{i("bookShelf",b,"extensions")}).ignoreElements(),t.saveTrackingEpic=(e,t)=>e.filter(e=>{var o;return e.type===d&&((null===(o=t.getState().bookShelf)||void 0===o?void 0:o._isEnabled)&&e.payload._bookShelf)}).mergeMap(()=>r.of(h()))},2215:function(e,t,o){"use strict";const n=o(2),r=o(0),{connect:i}=o(6),a=o(7),{updateArticle:s}=o(78),l=n({displayName:"BookShelfArticleButton",onClick(e){e.preventDefault();const{article:t}=this.props;let o=t._bookShelf._isShelved;o=!o,this.props.updateArticle({_id:t._id,_bookShelf:{...t._bookShelf,_isShelved:o}})},render(){var e;const{article:t}=this.props;if(null==t||null===(e=t._bookShelf)||void 0===e||!e._isEnabled)return null;const o=t._bookShelf._isShelved;return r.createElement("div",{className:"ev-article-action-bar-item"},r.createElement("button",{className:"ev-button ev-chromeless",onClick:this.onClick,"aria-label":this.props.ariaLabel,"aria-pressed":o},r.createElement("i",{className:a("ev-icon",{"ev-icon-bookmark":o,"ev-icon-book2":!o})})))}});e.exports=i(null,{updateArticle:s})(l)},2216:function(e,t,o){"use strict";const n=o(31),r=o(28),i=o(2),a=o(1),s=o(0),{connect:l}=o(6),c=o(7),d=o(30),h=o(76),p=o(467),u=o(524),b=o(172),{ContentContainer:S,HeroImage:_}=o(301),m=o(40),f=i({displayName:"BookShelf",propTypes:{bookShelf:a.shape({title:a.string,body:a.string,noItemsText:a.string,ariaLabel:a.string,_headerIcon:a.string,_heroImage:a.object}).isRequired,articles:a.array.isRequired,theme:a.object.isRequired,isReady:a.bool.isRequired},renderTitle(){if(this.props.bookShelf.title)return s.createElement(h,{headingElement:"h"+this.context,displayTitle:this.props.bookShelf.title,className:"ev-header-title",innerClassName:"ev-header-title-inner"})},renderBody(){if(this.props.bookShelf.body)return s.createElement(d,{className:"ev-header-body",innerClassName:"ev-header-body-inner",body:this.props.bookShelf.body})},renderNoItems(){const{bookShelf:e,articles:t}=this.props;if(!t.length)return s.createElement(p,null,s.createElement(d,{className:"ev-component-body",innerClassName:"ev-component-body-inner",body:e.noItemsText}))},renderArticles(){const{articles:e}=this.props;return e.length?r(e,e=>s.createElement(u,{key:e._id,articleId:e._id})):null},renderHeroImage(){const{_heroImage:e}=this.props.bookShelf;if(null!=e&&e._isEnabled)return s.createElement(m.Provider,{value:this.props.bookShelf.title?this.context+1:this.context},s.createElement(_,{title:e.title,body:e.body,graphic:e._graphic,_contentWidth:e._contentWidth,layout:e.layout,floatingGraphic:e._floatingGraphic,parentSelector:".ev-extension-hero-container",theme:this.props.theme,isReady:this.props.isReady}))},render(){var e,t,o,n;const{bookShelf:r,theme:i,isReady:a}=this.props,l=r._headerIcon,d=null===(e=i._extensions._bookShelf)||void 0===e||null===(t=e._settings)||void 0===t?void 0:t._headerIcon,h=l||d,p=r.title||null!==(o=r._heroImage)&&void 0!==o&&o._isEnabled&&null!==(n=r._heroImage)&&void 0!==n&&n.title?this.context+1:this.context;return s.createElement(S,{region:"bookshelf",className:"ev-extension ev-bookShelf",ariaLabel:r.ariaLabel},s.createElement("div",{className:"ev-extension-inner"},a?null:s.createElement(b,null),s.createElement("div",{className:"ev-extension-hero-container"},this.renderHeroImage()),s.createElement("div",{className:"ev-header"},s.createElement("div",{className:c("ev-header-inner ev-clearfix",{"ev-no-graphic":!h})},s.createElement("div",{className:"ev-header-left"},this.renderTitle(),this.renderBody()),h&&s.createElement("div",{className:"ev-header-right"},s.createElement("i",{className:"ev-icon ev-icon-"+h})))),s.createElement(m.Provider,{value:p},this.renderNoItems(),this.renderArticles())))}});f.contextType=m,e.exports=l(e=>({bookShelf:e.bookShelf,theme:e.theme,isReady:e.location.isLocationReady,articles:n(e.articles,({_bookShelf:e})=>(null==e?void 0:e._isEnabled)&&(null==e?void 0:e._isShelved))}))(f)},2217:function(e,t,o){"use strict";const n=o(12),{store:r}=o(4),{updateArticle:i}=o(78);e.exports={_articles:{fieldKey:"_articles",type:"Function",shouldRestore:!0,mapCallback:function(){const{articles:e}=r.getState(),t={};return n(e,e=>{var o;null!=e&&null!==(o=e._bookShelf)&&void 0!==o&&o._isEnabled&&(t[e._id]={_isShelved:e._bookShelf._isShelved})}),t},restoreCallback:function(e){const{articles:t}=r.getState();n(e._articles,(e,o)=>{const n=t[o];n&&r.dispatch(i({_id:o,_bookShelf:{...null==n?void 0:n._bookShelf,...e}}))})}}}}}]);
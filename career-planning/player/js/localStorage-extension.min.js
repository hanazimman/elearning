(window.webpackJsonp=window.webpackJsonp||[]).push([[57],{1328:function(e,a,o){"use strict";const{registerReducer:t,registerEpics:r}=o(4),S=o(2274),{localStorageSetupEpic:l,localStorageLoadSessionEpic:n,localStorageSaveSessionEpic:s,localStorageClearSessionEpic:c,localStorageComponentCompleteEpic:i,localStorageBookmarkingCancelEpic:E,localStorageHandleResetsEpic:O,localStorageLogicStateChangeEpic:p}=o(2275);t("_localStorage",S),r(l,n,s,c,i,E,O,p)},1606:function(e,a,o){"use strict";a.LOCALSTORAGE_LOAD_SESSION="LOCALSTORAGE_LOAD_SESSION",a.LOCALSTORAGE_SAVE_SESSION="LOCALSTORAGE_SAVE_SESSION",a.LOCALSTORAGE_CLEAR_SESSION="LOCALSTORAGE_CLEAR_SESSION",a.LOCALSTORAGE_SESSION_CHANGE="LOCALSTORAGE_SESSION_CHANGE",a.localStorageLoadSession=()=>({type:a.LOCALSTORAGE_LOAD_SESSION}),a.localStorageSaveSession=e=>({type:a.LOCALSTORAGE_SAVE_SESSION,payload:e}),a.localStorageClearSession=()=>({type:a.LOCALSTORAGE_CLEAR_SESSION}),a.localStorageSessionChange=e=>({type:a.LOCALSTORAGE_SESSION_CHANGE,payload:e})},2274:function(e,a,o){"use strict";const t=o(11),{SETUP_DATA:r}=o(9),S={_isEnabled:!1,session:{}},{LOCALSTORAGE_SESSION_CHANGE:l}=o(1606);e.exports=(e=S,a)=>{if(a.type===r){const o=a.payload.course._localStorage;return o&&o._isEnabled?t({},e,o):S}if(!e._isEnabled)return S;switch(a.type){case l:return t({},e,{session:a.payload});default:return e}}},2275:function(e,a,o){"use strict";var t=o(5);const r=o(57),S=o(34),l=o(17),n=o(11),s=o(302),{DATA_READY:c,setAppReadyState:i,resetCourse:E}=o(9),{COMPONENT_COMPLETED:O,COMPONENT_TRACKABLE_CHANGE:p}=o(61),{LOGIC_STATE_CHANGE:g}=o(50),{getTracking:_,setTracking:A,restoreComponentAttributes:L}=o(486),{LOCALSTORAGE_LOAD_SESSION:C,LOCALSTORAGE_SAVE_SESSION:u,LOCALSTORAGE_CLEAR_SESSION:R,localStorageLoadSession:d,localStorageSaveSession:b,localStorageClearSession:T,localStorageSessionChange:f}=o(1606);function v(e){try{null!==localStorage.getItem(e)&&localStorage.removeItem(e)}catch(e){console.warn("Localstorage not available for saving learning data",e)}}a.localStorageSetupEpic=(e,a)=>e.filter(e=>{if(e.type!==c)return!1;const{app:o,course:t}=a.getState(),r=t._localStorage;return!o.isLivePreview&&r&&r._isEnabled}).mergeMap(()=>t.Observable.concat(t.Observable.of(i("localStorage",!1)),t.Observable.of(d()),t.Observable.of(i("localStorage",!0)))),a.localStorageLoadSessionEpic=(e,a)=>e.ofType(C).mergeMap(()=>{const{course:e,scorm:o,components:r}=a.getState(),s=o&&o._isEnabled;let c;try{c=localStorage.getItem(e._id)}catch(e){return console.warn("Localstorage not available for saving learning componentData",e),t.Observable.empty()}if(c){if(c=JSON.parse(c),c.useAdvancedTracking)return A(c,!0),t.Observable.of(f(c));const e=function(e,a,o){return S(e).keys().map(t=>{const r=e[t],S=l(a.components,{_id:t});return o&&r._isComplete||!o?n({},r,S):r}).keyBy("_id").value()}(r,c,s);return L(e),t.Observable.of(f(c))}return t.Observable.empty()}).catch(e=>(console.warn("LocalStorage load error",e),t.Observable.of({type:"LOCALSTORAGE_ERROR",payload:e}))),a.localStorageSaveSessionEpic=(e,a)=>e.ofType(u).map(e=>{const o=function(e,a){const{course:o}=e;return _(e=>{const t=s({},e,{useAdvancedTracking:!0,lastCompletedComponentId:a||""});try{localStorage.setItem(o._id,JSON.stringify(t))}catch(e){console.warn("Localstorage not available for saving learning componentData",e)}return t})}(a.getState(),e.payload);return f(o)}).catch(e=>t.Observable.of({type:"LOCALSTORAGE_ERROR",payload:e})),a.localStorageClearSessionEpic=(e,a)=>e.ofType(R).map(()=>{const{course:e}=a.getState();return v(e._id),f({})}).catch(e=>t.Observable.of({type:"LOCALSTORAGE_ERROR",payload:e})),a.localStorageHandleResetsEpic=(e,a)=>e.filter(e=>{if(!r(["COURSE_ASSESSMENT_COMPONENTS_RESET","ACHIEVEMENTS_RESET_COURSE"],e.type))return!1;const{app:o,course:t}=a.getState(),S=t._localStorage;return!o.isLivePreview&&S&&S._isEnabled}).map(()=>{const{course:e}=a.getState();return v(e._id),f({})}).catch(e=>t.Observable.of({type:"LOCALSTORAGE_ERROR",payload:e})),a.localStorageComponentCompleteEpic=(e,a)=>e.filter(e=>{if(!r([O,p],e.type))return!1;const{app:o,_localStorage:t}=a.getState();return!o.isLivePreview&&t&&t._isEnabled}).map(e=>b(e.payload.componentId)),a.localStorageLogicStateChangeEpic=(e,a)=>e.filter(e=>{if(e.type!==g)return!1;const{app:o,_localStorage:t}=a.getState();return!o.isLivePreview&&t&&t._isEnabled}).map(()=>b()),a.localStorageBookmarkingCancelEpic=(e,a)=>e.filter(e=>{if("BOOKMARKING_CANCEL_CONTINUE"!==e.type)return!1;const{app:o,scorm:t,_localStorage:r}=a.getState();return(!t||!t._isEnabled)&&(!o.isLivePreview&&r&&r._isEnabled&&r._shouldResetUsingBookMarking)}).mergeMap(()=>t.Observable.concat(t.Observable.of(T()),t.Observable.of(E())))}}]);
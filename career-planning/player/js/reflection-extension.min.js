(window.webpackJsonp=window.webpackJsonp||[]).push([[77],{1332:function(e,t,n){"use strict";const{registerEpics:o,registerReducer:i}=n(4),{registerElementsEpic:r,checkOnCourseAttainmentMethod:s,checkOnCourseAssessmentMethod:l,checkOnOpenInputComponentsCompleted:a,checkOnAppReadyOrComponentsUpdatedEpic:c}=n(2296);i("reflection",n(2300)),o(r,s,l,a,c)},1392:function(e,t,n){"use strict";var o=n(24)(n(1451));e.exports=function(e,t=new Date){return"string"==typeof t&&(t=new Date(t)),(0,o.default)(t,function(e){return e.includes("DD")&&(e=e.replace("DD","dd")),e.includes("YYYY")&&(e=e.replace("YYYY","yyyy")),e}(e))}},1397:function(e,t,n){"use strict";const o=n(8);e.exports=(e,t,n)=>(Array.isArray(e)||(e=[e]),({type:i})=>-1!==e.indexOf(i)&&o(n.getState(),["course",t,"_isEnabled"],!1))},1398:function(e,t,n){"use strict";var o=n(24)(n(170));const i=n(171),r=n(142),s=n(86),l=n(1416);e.exports=function(){var e=(0,o.default)((function*(e,t=["_graphic","_primaryLogo","_secondaryLogo"],n=s){const o=i(t,(t,o)=>(e[o]&&(t[o]=n(e[o])),t),{});if(!r(o))return o;for(const[e,t]of Object.entries(o)){const n=yield l(t);o[e]=n}return o}));return function(t){return e.apply(this,arguments)}}()},1416:function(e,t,n){"use strict";var o=n(24)(n(170));e.exports=function(){var e=(0,o.default)((function*(e){const t=new Image;t.src=e,yield t.decode();const n=document.createElement("canvas"),o=n.getContext("2d"),i=t.width<500?t.width:500,r=t.width<500?t.height:i*t.height/t.width;return n.width=i,n.height=r,o.drawImage(t,0,0,i,r),n.toDataURL("image/png")}));return function(t){return e.apply(this,arguments)}}()},1417:function(e,t,n){"use strict";e.exports=[{attribute:"displayTitle",settingsKey:"componentDisplayTitle",canShowKey:"_displayComponentDisplayTitle",canShowDefault:!1},{attribute:"body",settingsKey:"componentBody",canShowKey:"_displayComponentBody",canShowDefault:!1},{attribute:"instruction",settingsKey:"componentQuestion",canShowKey:"_displayComponentInstruction",canShowDefault:!0}]},1450:function(e,t,n){"use strict";e.exports={COURSE_ASSESSMENT:"Course Assessment",COURSE_ASSESSMENT_PASSED:"Course Assessment Passed",COURSE_ATTAINMENT:"Course Attainment",OPEN_INPUTS:"Open Input Components",NONE:"None"}},1458:function(e,t,n){"use strict";const o=n(31),{createSelector:i}=n(54);t.reflectionComponentsSelector=i(e=>e.components,e=>o(e,e=>{var t;return null===(t=e._reflection)||void 0===t?void 0:t._isEnabled}))},1460:function(e,t,n){"use strict";(function(t){var o=n(24)(n(170));const i=n(31),r=n(141),s=n(12),l=n(8),a=n(1398),c=n(1392),u=n(480),d=n(1417);function m(e,t){s(e._items,n=>{const o=[],i=function({_fontSizes:e,_alignmentSettings:t},n){return n.title?{fontSize:e.itemTitle,alignment:t.itemTitle,margin:[0,0,0,5],text:n.title}:null}(e,n);null!==i&&o.push(i);const r=function({_fontSizes:e,_alignmentSettings:t},n){return n.body?{text:n.body,fontSize:e.itemBody,alignment:t.itemBody,margin:[0,0,0,20]}:null}(e,n);null!==r&&o.push(r),o.length&&t.content.push({stack:o,unbreakable:!1})})}e.exports=function(){var e=(0,o.default)((function*(e,n,o,f){const p=yield a(e),g={pageOrientation:"portrait",content:[]},h=function({_primaryLogo:e,_secondaryLogo:t}){if(!e&&!t)return null;const n={columns:[]},o=[100,100];if(e){const t={width:"50%",alignment:"left",stack:[{image:e,fit:o}]};n.columns.push(t)}if(t){const i={width:e?"50%":"100%",alignment:"right",stack:[{image:t,fit:o}]};n.columns.push(i)}return n}(p);null!==h&&g.content.push(h);const _=function({customTitle:e,_fontSizes:t,_alignmentSettings:n}){return e?{text:e,fontSize:t.customTitle,alignment:n.customTitle,margin:[0,20,0,20],bold:!0}:null}(e);if(null!==_&&g.content.push(_),null===_){const t=function({_fontSizes:e,_alignmentSettings:t},n){return{text:u(n.displayTitle),fontSize:e.customTitle,alignment:t.customTitle,margin:[0,0,0,20],bold:!0}}(e,n);g.content.push(t)}const S=function(e){if(!0===e._shouldNotShowDownloadsTitleInReflection)return null;const{title:t,_fontSizes:n,_alignmentSettings:o}=e;return{text:t,fontSize:n.downloadsTitle,alignment:o.downloadsTitle,margin:[0,0,0,0]}}(e);null!==S&&g.content.push(S);const E=function({reflectionMessage:e,_fontSizes:t,_alignmentSettings:n}){return e?{text:e,fontSize:t.reflectionMessage,alignment:n.reflectionMessage,margin:[0,0,0,20]}:null}(e);if(null!==E&&g.content.push(E),!e._shouldNotShowLearnerName){const t=function({nameLabel:e,_fontSizes:t,_alignmentSettings:n},o){const i={bold:!0,text:e,fontSize:t.name,width:"auto"},r={text:o,fontSize:t.name,width:"auto"};"right"===n.name&&(i.width="*",r.width="auto",i.alignment="right");return{margin:[0,0,0,0],columns:[i,r],columnGap:5}}(e,f);g.content.push(t)}const y=function(e){const t=l(e,"_dateFormat","DD/MM/YYYY"),n=e._fontSizes.date,o={fontSize:n,bold:!0,text:e.dateLabel,width:"auto"},i={fontSize:n,text:c(t),width:"auto"};"right"===e._alignmentSettings.date&&(o.width="*",i.width="auto",o.alignment="right");return{margin:[0,0,0,20],columns:[o,i],columnGap:5}}(e);g.content.push(y),e._shouldRenderItemsAfterComponents||m(e,g);let b=e._onlyShowCompleted?i(o,{_isComplete:!0}):o;b=r(b,e=>e._contentOrder),s(b,n=>{const o=[];d.forEach(({attribute:i,settingsKey:r,canShowDefault:s,canShowKey:a})=>{if(!l(e,a,s))return;const c=function({_fontSizes:e,_alignmentSettings:n},o,i,r){const s=o[i];if(!s)return null;let a=s.replace(/<br\s*[/]?>/gi,"\n");return a=t(`<div>${a}</div>`).text(),{text:a,fontSize:l(e,r,11),alignment:l(n,r,"left"),margin:[0,0,0,5],bold:!0}}(e,n,i,r);c&&o.push(c)});const i=function({_fontSizes:e,_alignmentSettings:t},n){if(!["openInput","linkedOpenInput"].includes(n._component))return null;return{margin:[0,0,0,20],table:{widths:["*"],body:[[{text:n._userAnswer||" ",fontSize:e.componentAnswer,alignment:t.componentAnswer}]]},layout:{paddingLeft:()=>10,paddingRight:()=>10,paddingTop:()=>10,paddingBottom:()=>10}}}(e,n);null!==i&&o.push(i),o.length&&g.content.push({stack:o,unbreakable:!1})}),e._shouldRenderItemsAfterComponents&&m(e,g);const w=function({footer:e,_fontSizes:t,_alignmentSettings:n}){return e?{text:e,fontSize:t.footer,alignment:n.footer,margin:[40,0,40,0]}:null}(e);return null!==w&&(g.footer=w),window.pdfMake.createPdf(g)}));return function(t,n,o,i){return e.apply(this,arguments)}}()}).call(this,n(27))},1461:function(e,t,n){"use strict";(function(t){var o=n(24)(n(170));const i=n(8),r=n(141),s=n(1398),l=n(480),a=n(1392),c=n(1417);function u(e){const t=[];return e.fontSize&&t.push(`font-size: ${e.fontSize}px`),e.fontWeight&&t.push("font-weight: "+e.fontWeight),e.alignment&&t.push("text-align: "+e.alignment),e.margin&&t.push("margin: "+e.margin),e.padding&&t.push("padding: "+e.padding),e.hasBorder&&t.push("border: 1px solid black"),`<div style="${t.join("; ")}">${e.content}</div>`}function d(e){let t="";return e._items.forEach(n=>{n.title&&(t+=u({content:n.title,fontSize:e._fontSizes.itemTitle,fontWeight:"normal",margin:"0 0 5px 0",alignment:e._alignmentSettings.itemTitle})),n.body&&(t+=u({content:n.body,fontSize:e._fontSizes.itemBody,fontWeight:"normal",margin:"0 0 20px 0",alignment:e._alignmentSettings.itemBody}))}),t}function m(e,n,o,s,m){return`<!DOCTYPE html>\n    <html>\n        <head>\n            <meta charset="utf-8">\n            <title>\n                ${e.customTitle||l(n.displayTitle)}\n            </title>\n            <style type="text/css">\n                body { font-family: sans-serif; margin-top: 0px; }\n    .ev-print-header {\n        padding: 10px;\n        margin-top: 5px;\n        display: flex;\n    }\n    .ev-print-instruction { padding-bottom: 5px; }\n    .ev-button {\n        cursor: pointer;\n        color: #fff;\n        background: #4fc1e9;\n        padding: 8px 12px 8px 12px;\n        border-radius: 2px;\n        border: none;\n        margin: 0 15px 5px 0;\n    }\n    .ev-button:hover {\n        background: #3bafda;\n        box-shadow: 5px 40px -10px rgba(0,0,0,0.57);\n    }\n    .ev-logo-container { display: flex; }\n    .ev-logo-secondary { margin-left: auto; }\n    @media print {\n        .ev-print-header { display: none !important; }\n    }\n            </style>\n        </head>\n        <body>\n            ${function(e){return`<div class="ev-print-header">\n                <div class="ev-button-container">\n                    <button class="ev-button" onclick="window.print(); return false;">\n                        ${e.printHtmlLabel}\n                    </button>\n                </div>\n                <div class="ev-print-instruction">\n                    ${e.printHtmlInstruction}\n                </div>\n            </div>`}(e)}\n            </div>\n            <div class="ev-reflection-container">\n                ${function(e){if(!e._primaryLogo&&!e._secondaryLogo)return"";let t='<div class="ev-logo-container">';return e._primaryLogo&&(t+=`<div class="ev-logo-primary">\n            <img src="${e._primaryLogo}" />\n        </div>`),e._secondaryLogo&&(t+=`<div class="ev-logo-secondary">\n            <img src="${e._secondaryLogo}" />\n        </div>`),t+"</div>"}(m)}\n                ${function(e,t){return u({content:e.customTitle||l(t),fontSize:e._fontSizes.customTitle,fontWeight:"bold",margin:"20px 0 20px 0",alignment:e._alignmentSettings.customTitle})}(e,n.displayTitle)}\n                ${function(e){return e._shouldNotShowDownloadsTitleInReflection?"":u({content:e.title,fontSize:e._fontSizes.downloadsTitle,fontWeight:"normal",margin:"0 0 0 0",alignment:e._alignmentSettings.downloadsTitle})}(e)}\n                ${function(e){return e.reflectionMessage?u({content:e.reflectionMessage,fontSize:e._fontSizes.reflectionMessage,fontWeight:"normal",margin:"0 0 20px 0",alignment:e._alignmentSettings.reflectionMessage}):""}(e)}\n                ${function(e,t){return e._shouldNotShowLearnerName?"":u({content:`<b>${e.nameLabel}</b> ${t}`,fontSize:e._fontSizes.name,fontWeight:"normal",margin:"0 0 0 0",alignment:e._alignmentSettings.name})}(e,s)}\n                ${function(e){const t=i(e,"_dateFormat","DD/MM/YYYY");return u({content:`<b>${e.dateLabel}</b> ${a(t)}`,fontSize:e._fontSizes.date,fontWeight:"normal",margin:"0 0 20px 0",alignment:e._alignmentSettings.date})}(e)}\n                ${e._shouldRenderItemsAfterComponents?"":d(e)}\n                ${function(e,n){let o=e._onlyShowCompleted?n.filter(e=>e._isComplete):n;o=r(o,e=>e._contentOrder);let s="";return o.forEach(n=>{c.forEach(({attribute:t,settingsKey:o,canShowKey:r,canShowDefault:l})=>{if(!i(e,r,l))return;const a=n[t];a&&(s+=u({content:a,fontSize:i(e._fontSizes,o,11),fontWeight:"bold",margin:"0 0 5px 0",alignment:i(e._alignmentSettings,o,"left")}))});const o=t("<div>").text(n._userAnswer).html();s+=u({content:o.replace(/\n/gi,"<br/>"),fontSize:e._fontSizes.componentAnswer,fontWeight:"normal",margin:"0 0 20px 0",padding:"10px 10px 10px 10px",hasBorder:!0,alignment:e._alignmentSettings.componentAnswer})}),s}(e,o)}\n                ${e._shouldRenderItemsAfterComponents?d(e):""}\n                ${function(e){return e.footer?u({content:e.footer,fontSize:e._fontSizes.footer,fontWeight:"normal",margin:"40px 0 40px 0",alignment:e._alignmentSettings.footer}):""}(e)}\n            </div>\n        </body>\n    </html>`}e.exports=function(){var e=(0,o.default)((function*(e,t,n,o){const i=m(e,t,n,o,yield s(e)),r=new Blob([i],{type:"text/html"}),l=URL.createObjectURL(r);window.open(l,"reflection")}));return function(t,n,o,i){return e.apply(this,arguments)}}()}).call(this,n(27))},1607:function(e,t,n){"use strict";t.REFLECTION_COMPLETED="REFLECTION_COMPLETED",t.reflectionCompleted=e=>({type:t.REFLECTION_COMPLETED,payload:e})},1608:function(e,t,n){"use strict";const o=n(8),{COURSE_ASSESSMENT:i,COURSE_ASSESSMENT_PASSED:r}=n(1450);e.exports=({course:e,courseAssessment:t={}})=>!(!o(e,"_reflection._isEnabled")||!o(e,"_courseAssessment._isEnabled")||e._reflection._obtainmentMethod!==i&&e._reflection._obtainmentMethod!==r||!t._isComplete)&&!(e._reflection._obtainmentMethod===r&&!t._isPassed)},1609:function(e,t,n){"use strict";const o=n(8),{COURSE_ATTAINMENT:i}=n(1450);e.exports=({course:e,courseAttainment:t={}})=>!!(o(e,"_reflection._isEnabled")&&o(e,"_courseAttainment._isEnabled")&&e._reflection._obtainmentMethod===i&&t._isComplete)},1610:function(e,t,n){"use strict";const o=n(8),i=n(12),{OPEN_INPUTS:r}=n(1450);e.exports=({course:e,components:t})=>{if(!o(e,"_reflection._isEnabled")||e._reflection._obtainmentMethod!==r)return!1;let n=0,s=0;return i(t,e=>{"openInput"===e._component&&(n++,e._isComplete&&s++)}),!(!n||s!==n)}},2296:function(e,t,n){"use strict";const o=n(0),{Redirect:i}=n(35),{Observable:r}=n(5),s=n(1397),{SETUP_APP:l,APP_STARTED:a}=n(9),{addElement:c}=n(42),{COMPONENT_COMPLETED:u,COMPONENTS_UPDATED:d}=n(61),{addPrompt:m}=n(97),{loadPdfMake:f}=n(502),{COURSE_ATTAINMENT_COMPONENT_COMPLETED:p,COURSE_ATTAINMENT_ACHIEVEMENTS_UPDATED:g}=n(487),{COURSE_ASSESSMENT_COMPLETE:h}=n(476),_=n(2297),{reflectionCompleted:S}=n(1607),E=n(2299),y=n(1608),b=n(1609),w=n(1610);function T({course:e}){const t=[S(!0)];if(!e._reflection._hideDialog){const n={title:e._reflection.title,body:e._reflection.downloadAvailableText,_action:{text:e._downloads.viewDownloadsButtonText,_link:{_link:"downloads",_linkType:"extensions"}},_glyph:{_type:"icon",_icon:"license"}};t.push(m(n))}return r.of(...t)}t.registerElementsEpic=(e,t)=>e.filter(s(l,"_reflection",t)).mergeMap(()=>{const e=t.getState(),n=[f(),c({props:{},component:_,parent:"downloads",name:"reflection"}),c({parent:"router",name:"reflectionRedirect",path:"/reflection",exact:!0,render:()=>o.createElement(i,{to:"/downloads"})})];return E(e)&&n.push(S(!0)),r.of(...n)}),t.checkOnAppReadyOrComponentsUpdatedEpic=(e,t)=>e.filter(s([a,d],"_reflection",t)).mergeMap(()=>{const e=t.getState();return e.reflection.isComplete&&!E(e)?r.of(S(!1)):r.empty()}),t.checkOnCourseAttainmentMethod=(e,t)=>e.filter(({type:e})=>{if(e!==g&&e!==p)return!1;const n=t.getState();return!n.reflection.isComplete&&b(n)}).mergeMap(()=>T(t.getState())),t.checkOnCourseAssessmentMethod=(e,t)=>e.filter(({type:e})=>{if(e!==h)return!1;const n=t.getState();return!n.reflection.isComplete&&y(n)}).mergeMap(()=>T(t.getState())),t.checkOnOpenInputComponentsCompleted=(e,t)=>e.filter(({type:e})=>{if(e!==u)return!1;const n=t.getState();return!n.reflection.isComplete&&w(n)}).mergeMap(()=>T(t.getState()))},2297:function(e,t,n){"use strict";var o=n(24)(n(32));const{connect:i}=n(6),r=n(0),{reflectionComponentsSelector:s}=n(1458),l=n(2298);e.exports=i(e=>({course:e.course,device:e.device,isComplete:e.reflection.isComplete,components:s(e)}))(e=>r.createElement(l,(0,o.default)({},e,{reflection:e.course._reflection})))},2298:function(e,t,n){"use strict";var o=n(24)(n(170));const i=n(2),r=n(1),s=n(0),l=n(1460),a=n(1461),c=i({displayName:"ReflectionDownload",propTypes:{reflection:r.object.isRequired,username:r.string.isRequired,course:r.object.isRequired,components:r.array.isRequired,isComplete:r.bool.isRequired,downloads:r.object,device:r.object.isRequired},onDownloadReflectionClicked(e){var t=this;return(0,o.default)((function*(){e.preventDefault(),e.currentTarget.blur();const{reflection:n,course:o,components:i,username:r}=t.props;if(n._isHtmlFormat)return void a(n,o,i,r);const s=yield l(n,o,i,r);if(t.props.device.touch&&!t.props.device.isWindowsTouchScreen)return s.open();const c=(null==n?void 0:n.fileName)||"Reflection";s.download(c+".pdf")}))()},isLearnerNameRequired(){const{reflection:e,username:t}=this.props;return!e._shouldNotShowLearnerName&&!t},renderDownloadButton(){const e=!this.props.isComplete||this.isLearnerNameRequired();return s.createElement("button",{className:"ev-button ev-reflection-download",onClick:this.onDownloadReflectionClicked,disabled:e},this.props.reflection.downloadButtonText)},renderReflectionItemText(){const{reflection:e,isComplete:t}=this.props,n=t?e.downloadAvailableText:e.downloadNotAvailableText;return s.createElement("div",null,n)},renderNameRequiredText(){if(this.props.isComplete&&this.isLearnerNameRequired())return s.createElement("span",{className:"ev-reflection-action-warning ev-label"},s.createElement("strong",null,this.props.downloads.nameRequiredText))},render(){return s.createElement("div",{className:"ev-list-item ev-reflection-download"},s.createElement("div",{className:"ev-list-item-inner ev-clearfix"},s.createElement("div",{className:"ev-list-item-left"},s.createElement("div",{className:"ev-list-item-title"},this.props.reflection.title),s.createElement("div",{className:"ev-list-item-content"},this.renderReflectionItemText())),s.createElement("div",{className:"ev-list-item-right"},this.renderNameRequiredText(),this.renderDownloadButton())))}});e.exports=c},2299:function(e,t,n){"use strict";const o=n(1450),i=n(1608),r=n(1609),s=n(1610);e.exports=e=>{let t=!1;switch(e.course._reflection._obtainmentMethod){case o.COURSE_ASSESSMENT:case o.COURSE_ASSESSMENT_PASSED:t=i(e);break;case o.COURSE_ATTAINMENT:t=r(e);break;case o.OPEN_INPUTS:t=s(e);break;case o.NONE:t=!0}return t}},2300:function(e,t,n){"use strict";const{SETUP_APP:o}=n(9),{REFLECTION_COMPLETED:i}=n(1607),r={isComplete:!1};e.exports=(e=r,t)=>{if(t.type===o){const n=t.payload.course._reflection;return n&&n._isEnabled?e:r}switch(t.type){case i:return{...e,isComplete:t.payload};default:return e}}}}]);
(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{1321:function(e,t,n){"use strict";const{registerEpics:c,registerReducer:o}=n(4),i=n(2229),{registerContentLockingElementsEpic:s,mapAppReadyToSetupContentLockingEpic:r,setContentLockedItemsInitialStateEpic:a,checkItemsUnlockedOnContentObjectCompletedEpic:l,checkItemsUnlockedOnArticleCompletedEpic:p,checkItemsUnlockedOnComponentCompletedEpic:_,checkItemsUnlockedOnAchievementsGained:d}=n(2230);c(s,r,a,_,p,l,d),o("contentLocking",i)},1449:function(e,t,n){"use strict";t.ACHIEVEMENTS_COMPONENT_COMPLETED="ACHIEVEMENTS_COMPONENT_COMPLETED",t.ACHIEVEMENTS_RESET_COURSE="ACHIEVEMENTS_RESET_COURSE",t.achievementsComponentCompleted=e=>({type:t.ACHIEVEMENTS_COMPONENT_COMPLETED,payload:e})},2229:function(e,t,n){"use strict";const c=n(99),o=n(90),i=n(12),s=n(8),{SETUP_APP:r}=n(9),a={article:[],component:[],contentObject:[],"stars gained":[],"points gained":[]};e.exports=(e=a,t)=>{if(t.type===r){const{course:n,contentObjects:r,articles:l}=t.payload;if(n._contentLocking&&n._contentLocking._isEnabled){const t=c(e,()=>[]),a=[...o(l),...o(r)];return i(a,e=>{if(!e._contentLocking||!e._contentLocking._isEnabled)return;let c=e._contentLocking._lockingType,o=!0;"correct components"===c&&(c="component"),("stars gained"!==c||s(n,"_achievements._stars._isEnabled"))&&("points gained"!==c||s(n,"_achievements._points._isEnabled"))||(o=!1),o&&t[c].push(e._id)}),t}return a}return e}},2230:function(e,t,n){"use strict";const c=n(139),o=n(34),{Observable:i}=n(5),{COMPONENT_COMPLETED:s}=n(61),{APP_READY:r,SETUP_APP:a}=n(9),{updateContentObjects:l,CONTENT_OBJECT_COMPLETED:p}=n(39),{updateArticles:_,ARTICLE_COMPLETED:d}=n(78),{addElement:k}=n(42),{addClassName:E,removeClassName:u}=n(181),{ACHIEVEMENTS_COMPONENT_COMPLETED:m}=n(1449),{SET_CONTENT_LOCKED_ITEMS_INITIAL_STATE:g,setContentLockingInitialState:L}=n(2231),T=n(2232),C=n(2233),O=n(2234),N=n(2235),y=n(2236),f=n(2237),S=n(2238);t.registerContentLockingElementsEpic=(e,t)=>e.filter(T(a,t)).map(()=>k({parent:"article",name:"articleLock",component:S,position:"top"})),t.mapAppReadyToSetupContentLockingEpic=(e,t)=>e.filter(({type:e})=>{if(e!==r)return!1;const{app:{isPagePreview:n},course:c}=t.getState();return!n&&c._contentLocking&&c._contentLocking._isEnabled}).mapTo(L()),t.setContentLockedItemsInitialStateEpic=(e,t)=>e.ofType(g).mergeMap(()=>{const e=t.getState(),n=[...N(e.articles,e),...O(e.articles,e),...C(e.articles,e),...y(e.articles,e)],s=[...N(e.contentObjects,e),...O(e.contentObjects,e),...C(e.contentObjects,e),...y(e.contentObjects,e)],r=c(n,"_id"),a=c(s,"_id"),p=o(n).filter(e=>"blur"===e._contentLocking._lockedApperance).map(e=>(e._isLocked?E:u)({_id:e._id,className:"ev-is-blurred"})).value();return i.of(_(r),l(a),...p)}),t.checkItemsUnlockedOnComponentCompletedEpic=(e,t)=>e.filter(T(s,t)).mergeMap(()=>{const e=t.getState();return i.of(...N(e.articles,e),...N(e.contentObjects,e))}).mergeMap(e=>f(e,t.getState())),t.checkItemsUnlockedOnArticleCompletedEpic=(e,t)=>e.filter(T(d,t)).mergeMap(()=>{const e=t.getState();return i.of(...O(e.articles,e),...O(e.contentObjects,e))}).mergeMap(e=>f(e,t.getState())),t.checkItemsUnlockedOnContentObjectCompletedEpic=(e,t)=>e.filter(T(p,t)).mergeMap(()=>{const e=t.getState();return i.of(...C(e.articles,e),...C(e.contentObjects,e))}).mergeMap(e=>f(e,t.getState())),t.checkItemsUnlockedOnAchievementsGained=(e,t)=>e.filter(T(m,t)).mergeMap(()=>{const e=t.getState();return i.of(...y(e.articles,e),...y(e.contentObjects,e))}).mergeMap(e=>f(e,t.getState()))},2231:function(e,t,n){"use strict";t.SET_CONTENT_LOCKED_ITEMS_INITIAL_STATE="SET_CONTENT_LOCKED_ITEMS_INITIAL_STATE",t.SET_CONTENT_LOCKING_AS_READY="SET_CONTENT_LOCKING_AS_READY",t.setContentLockingInitialState=()=>({type:t.SET_CONTENT_LOCKED_ITEMS_INITIAL_STATE}),t.setContentLockingAsReady=()=>({type:t.SET_CONTENT_LOCKING_AS_READY})},2232:function(e,t,n){"use strict";const c=n(8);e.exports=(e,t)=>n=>{const{app:{isPagePreview:o},course:i}=t.getState();return n.type===e&&!o&&c(i,"_contentLocking._isEnabled",!1)}},2233:function(e,t,n){"use strict";const c=n(43),o=n(171),i=n(31),s=n(17),r=n(122),a=n(145);e.exports=(e,t)=>(e=c(e,t.contentLocking.contentObject),o(e,(e,n,c)=>{let o=a(n._contentLocking._requiredCompleteIds,t);o=i(o,e=>"page"===e._type||"menu");const l=!!s(o,e=>!r(e,t));return l!==n._isLocked&&e.push({_id:n._id,_isLocked:l,_contentLocking:n._contentLocking,_type:n._type,displayTitle:n.displayTitle}),e},[]))},2234:function(e,t,n){"use strict";const c=n(43),o=n(171),i=n(31),s=n(17),r=n(122),a=n(145);e.exports=(e,t)=>(e=c(e,t.contentLocking.article),o(e,(e,n,c)=>{let o=a(n._contentLocking._requiredCompleteIds,t);o=i(o,e=>"article"===e._type);const l=!!s(o,e=>!r(e,t));return l!==n._isLocked&&e.push({_id:n._id,_isLocked:l,_contentLocking:n._contentLocking,_type:n._type,displayTitle:n.displayTitle}),e},[]))},2235:function(e,t,n){"use strict";const c=n(43),o=n(171),i=n(31),s=n(17),r=n(145);e.exports=(e,t)=>(e=c(e,t.contentLocking.component),o(e,(e,n,c)=>{const o="correct components"===n._contentLocking._lockingType;let a=r(n._contentLocking._requiredCompleteIds,t);a=i(a,e=>o?"component"===e._type&&e._isQuestionType:"component"===e._type);const l=!!s(a,e=>o?!e._isComplete||!e._isCorrect:!e._isComplete);return l!==n._isLocked&&e.push({_id:n._id,_isLocked:l,_contentLocking:n._contentLocking,_type:n._type,displayTitle:n.displayTitle}),e},[]))},2236:function(e,t,n){"use strict";const c=n(43),o=n(8),i=n(171);function s(e,t){return a(e=c(e,t.contentLocking["points gained"]),o(t,"achievements._points._currentPoints",0))}function r(e,t){return a(e=c(e,t.contentLocking["stars gained"]),o(t,"achievements._stars._currentStarsCollected",0))}function a(e,t){return i(e,(e,n,c)=>{const o=n._contentLocking._requiredAmount>t;return o!==n._isLocked&&e.push({_id:n._id,_isLocked:o,_contentLocking:n._contentLocking,_type:n._type,displayTitle:n.displayTitle}),e},[])}e.exports=(e,t)=>[...s(e,t),...r(e,t)]},2237:function(e,t,n){"use strict";const{Observable:c}=n(5),{updateContentObject:o}=n(39),{updateArticle:i}=n(78),{addPrompt:s}=n(97),{addClassName:r,removeClassName:a}=n(181);e.exports=(e,t)=>{if(!t.app.isAppReady)return c.empty();const n=[];if("article"===e._type){if(n.push(i(e)),"blur"===e._contentLocking._lockedApperance){const t=e._isLocked?r:a;n.push(t({_id:e._id,className:"ev-is-blurred"}))}}else n.push(o(e));return e._isLocked||e._contentLocking._shouldDisableNotifyOnUnlock||n.push(s({title:e.displayTitle,body:t.course._contentLocking.unlockedNotifyMessage,_glyph:{_type:"icon",_icon:"unlock"}})),c.of(...n)}},2238:function(e,t,n){"use strict";const c=n(8),o=n(2),i=n(1),s=n(0),{connect:r}=n(6),a=n(2239),l=o({displayName:"ArticleLockContainer",propTypes:{article:i.object.isRequired,isEnabled:i.bool.isRequired,contentLocking:i.object},render:function(){return s.createElement(a,this.props)}});e.exports=r((e,t)=>({isEnabled:c(e.course,"_contentLocking._isEnabled",!1)&&c(t.article,"_contentLocking._isEnabled",!1),contentLocking:e.course._contentLocking}))(l)},2239:function(e,t,n){"use strict";const c=n(8),o=n(2),i=n(1),s=n(0),r=n(7),a=n(30),l=o({displayName:"ArticleLock",propTypes:{article:i.object.isRequired,isEnabled:i.bool.isRequired,contentLocking:i.object},getLockAppearance:function(){const{article:e}=this.props;return c(e,"_contentLocking._lockedApperance","default")},getClassName:function(){const{props:e}=this;return r("ev-article-lock",{"ev-locked":e.article._isLocked})},getLockIconClassName:function(){const e=this.props.article._contentLocking._lockIcon;return r("ev-article-lock-icon","ev-icon",{"ev-icon-lock":"lock"===e,"ev-icon-key":"key"===e,"ev-icon-key-hole":"key hole"===e,"ev-icon-star":"star"===e,"ev-icon-check":"check"===e,"ev-icon-trophy2":"trophy"===e,"ev-icon-exclamation":"exclamation"===e,"ev-icon-question":"question"===e})},getOvelayClassName:function(){const{contentLocking:e}=this.props;return r("ev-article-lock-overlay ev-article-lock-appearance-"+this.getLockAppearance())},renderLockedText:function(){const{article:e}=this.props,t=e._contentLocking._lockedText;if(t)return s.createElement(a,{className:"ev-article-lock-text",body:t})},render:function(){const{props:e}=this;return e.isEnabled?s.createElement("div",{className:this.getClassName()},s.createElement("div",{className:this.getOvelayClassName()},s.createElement("div",{className:"ev-article-lock-overlay-panel"}),s.createElement("div",{className:"ev-article-lock-strip"},s.createElement("div",{className:"ev-article-lock-circle"},s.createElement("i",{className:this.getLockIconClassName()}))),this.renderLockedText())):null}});e.exports=l}}]);
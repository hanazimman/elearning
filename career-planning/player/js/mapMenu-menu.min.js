(window.webpackJsonp=window.webpackJsonp||[]).push([[58],{1308:function(e,t,n){"use strict";const{registerMenu:i}=n(4);i("mapMenu",n(2173))},1391:function(e,t,n){"use strict";e.exports=function(e){var t;const n=e.displayTitle,i=null!==(t=e._heroImage)&&void 0!==t&&t._isEnabled?e._heroImage.title:null;return n||i}},1493:function(e,t,n){var i=n(495),o=n(49),s=n(1494),r=n(19),a=n(221);e.exports=function(e,t,n){var l=r(e)?i:s;return n&&a(e,t,n)&&(t=void 0),l(e,o(t,3))}},1494:function(e,t,n){var i=n(100);e.exports=function(e,t){var n;return i(e,(function(e,i,o){return!(n=t(e,i,o))})),!!n}},2173:function(e,t,n){"use strict";const i=n(8),o=n(28),s=n(1493),r=n(2),a=n(1),l=n(0),{connect:m}=n(6),c=n(7),u=n(298),{addPrompt:p}=n(474),{setAriaLive:d}=n(58),h=n(40),g=n(62),v=n(143),I=n(226),f=n(478),M=n(2174),_=n(2175),b=n(2176),y=n(2177),C=n(2178),E=r({displayName:"MapMenu",propTypes:{menu:a.object.isRequired,device:a.object.isRequired,theme:a.object.isRequired,itemIds:a.array.isRequired,course:a.object.isRequired,addPrompt:a.func.isRequired,setAriaLive:a.func.isRequired,hasActionBar:a.bool.isRequired,classList:a.array},getInitialState(){return this.getDefaultState()},getDefaultState:()=>({_isDragging:!1,_isShowingInfo:!1,_selectedItemId:null}),componentDidMount(){const{props:e}=this;e.menu.ariaLabel&&e.setAriaLive({message:e.menu.ariaLabel,delay:200}),this.checkMapMenuImage(),this.checkMapMenuPointerImages()},checkMapMenuImage(){this.props.menu._mapMenu._mapImage||this.showErrorPrompt("No Map Menu image was found!","Make sure you have set a Map Menu image in Evolve")},checkMapMenuPointerImages(){if(this.getDefaultPointerImage())return;s(this.props.itemIds,e=>{var t;const n=u(e);return!!n&&null===(null===(t=n._mapMenu)||void 0===t?void 0:t._pointerImage)})&&this.showErrorPrompt("No default Map Menu pointer image was found!","Make sure you have set a default menu pointer image in Evolve")},showErrorPrompt(e,t){this.props.addPrompt({title:e,body:t,_glyph:{_type:"icon",_icon:"cross"}})},getClassName(){const{props:e,state:t}=this;return c("ev-map-menu ev-menu",e.classList,{"ev-is-dragging":t._isDragging,"ev-use-menu-header-styles":e.theme._menu._settings._useMenuHeaderStyles,"ev-disable-inner-flex":e.theme._footer._settings._isStickyFooterDisabled})},getDefaultPointerImage(){const{props:e}=this;return i(e.course,"_mapMenu._defaultPointerImage")},getCloseButtonText(){const{props:e}=this;return i(e.course,"_mapMenu._closeButtonText")},getIsModalOpen(){const{state:e}=this;return!(!e._isShowingInfo&&!e._selectedItemId)},getMenuBody(){const{props:e}=this;return"course"===e.menu._type?e.menu.body:e.menu.description},onPointerClick(e){this.setState({_selectedItemId:e._id,_isShowingInfo:!1})},onInfoClick(){this.setState({_isShowingInfo:!0,_selectedItemId:null})},onInfoCloseClick(){this.setState({_isShowingInfo:!1})},onCloseMenuItemClick(){this.setState({_selectedItemId:null})},renderTitle(){const{menu:e}=this.props;if(e.displayTitle&&e._mapMenu._shouldShowTitleBar)return l.createElement(M,{title:e.displayTitle,body:this.getMenuBody(),infoOpenButtonAriaLabel:e._mapMenu.infoOpenButtonAriaLabel,onInfoClick:this.onInfoClick,isModalOpen:this.getIsModalOpen()})},renderItems(){const{props:e}=this;return o(e.itemIds,t=>l.createElement(b,{key:t,itemId:t,defaultPointerImage:this.getDefaultPointerImage(),defaultPointerWidth:e.menu._mapMenu._defaultPointerWidth,isModalOpen:this.getIsModalOpen(),onClick:this.onPointerClick}))},renderMapMenuImage(){const e=this.props.menu._mapMenu._mapImage;if(!e)return;const{props:t,state:n}=this;return l.createElement(_,{graphic:e,alt:t.menu._mapMenu.mapImageAltText,menuImageWidth:i(t,"menu._mapMenu._menuImageWidth",1024),menuScrollableContainerMaxWidth:i(t,"menu._mapMenu._menuScrollableContainerMaxWidth",1024),device:t.device,isModalOpen:this.getIsModalOpen(),isDragging:n._isDragging,onDragStart:()=>this.setState({_isDragging:!0}),onDragEnd:()=>this.setState({_isDragging:!1})},this.renderItems())},renderInfo(){if(this.state._isShowingInfo)return l.createElement(y,{body:this.getMenuBody(),closeButtonText:this.getCloseButtonText(),onInfoCloseClick:this.onInfoCloseClick})},getShouldShowProgressBars(){const{props:e}=this,t=i(e.theme,"_menu._settings._shouldShowProgressBarsOnMenus","content"),n=i(e.menu,"_mapMenu._shouldShowProgressBarsOnMenus",!0);return"content"===t?n:"true"===t},renderMenuItem(){var e,t;if(this.state._selectedItemId)return l.createElement(C,{itemId:this.state._selectedItemId,closeButtonText:this.getCloseButtonText(),onCloseMenuItemClick:this.onCloseMenuItemClick,shouldShowProgressBarsOnMenus:this.getShouldShowProgressBars(),durationIcon:null===(e=this.props.theme._menu)||void 0===e||null===(t=e._settings)||void 0===t?void 0:t._durationIcon})},renderActionBar(){if(this.props.hasActionBar)return l.createElement("div",{className:"ev-action-bar-container"},this.renderElements("actionBar"))},renderElements(e){return g("menu",e,{menu:this.props.menu})},render(){const e=v(),t=this.props.menu.displayTitle&&this.props.menu._mapMenu._shouldShowTitleBar?this.context+1:this.context;return l.createElement(I,null,l.createElement("div",{className:this.getClassName()},f(this.props.menu),l.createElement("main",{className:"ev-menu-container ev-map-menu-container",style:{minHeight:`calc(100vh - ${e})`}},l.createElement("div",{className:"menu-root"},this.renderElements("root")),l.createElement("div",{className:"ev-menu-container-inner ev-map-menu-container-inner"},this.renderTitle(),l.createElement(h.Provider,{value:t},this.renderMapMenuImage(),this.renderActionBar(),this.renderInfo(),this.renderMenuItem())),l.createElement("div",{className:"ev-menu-footer"},this.renderElements("footer")))))}});E.contextType=h,e.exports=m(null,{addPrompt:p,setAriaLive:d})(E)},2174:function(e,t,n){"use strict";const i=n(2),o=n(1),s=n(0),r=n(7),a=n(76),l=n(40),m=i({displayName:"MapMenuTitle",propTypes:{title:o.string.isRequired,body:o.string,onInfoClick:o.func.isRequired,isModalOpen:o.bool.isRequired,infoOpenButtonAriaLabel:o.string},onInfoClick(e){e.preventDefault(),e.currentTarget.blur(),this.props.onInfoClick()},renderInfoButton(){const{props:e}=this;if(e.body)return s.createElement("button",{className:r("ev-map-menu-button ev-map-menu-information-button",{"ev-disabled":e.isModalOpen}),disabled:e.isModalOpen,onClick:this.onInfoClick,"aria-label":e.infoOpenButtonAriaLabel},s.createElement("i",{className:"ev-icon ev-icon-question"}))},render(){return s.createElement(a,{headingElement:"h"+this.context,displayTitle:this.props.title,className:"ev-map-menu-title",innerClassName:"ev-map-menu-title-inner"},e=>s.createElement(s.Fragment,null,e,this.renderInfoButton()))}});m.contextType=l,e.exports=m},2175:function(e,t,n){"use strict";(function(t){const i=n(2),o=n(1),s=n(0),r=n(7),a=n(477),l=n(96),m=i({displayName:"MapMenuImage",propTypes:{graphic:o.object.isRequired,device:o.object.isRequired,isModalOpen:o.bool.isRequired,isDragging:o.bool.isRequired,onDragStart:o.func.isRequired,onDragEnd:o.func.isRequired,menuImageWidth:o.number.isRequired,menuScrollableContainerMaxWidth:o.number.isRequired,alt:o.string},getInitialState:()=>({_graphicHeight:null,_graphicWidth:null,_contentHeight:null,_x:0,_y:0}),componentDidMount(){this.setInteract(),this.setContentHeight()},componentDidUpdate({device:e,menuImageWidth:t}){e.windowHeight===this.props.device.windowHeight&&e.orientation===this.props.device.orientation&&t===this.props.menuImageWidth||(this.setImageWidth(),this.setContentHeight())},componentWillUnmount(){a(this._scrollable).unset()},setInteract(){a(this._scrollable).draggable({onmove:this.onDragMove,onend:this.onDragEnd,ignoreFrom:".ev-map-menu-pointer"})},setImageWidth(){const e=this._graphic.getRef(),{naturalWidth:t,naturalHeight:n}=e,{menuImageWidth:i}=this.props,o=0===i?1024:i,s=o/(t/n);this.setState({_graphicWidth:o,_graphicHeight:s})},setContentHeight(){const{windowHeight:e}=this.props.device,{top:n}=t(".ev-container").offset(),i=e-n;this.setState({_contentHeight:i>600?600:i})},getScrollableStyle(){const{_graphicHeight:e,_graphicWidth:t,_x:n,_y:i}=this.state;return{height:e,width:t,transform:`translate(${n}px, ${i}px)`}},onDragMove(e){const{props:t}=this;t.isModalOpen||(t.isDragging||t.onDragStart(),this.setState({_x:this.state._x+e.dx,_y:this.state._y+e.dy}))},onDragEnd(){this.props.onDragEnd()},render(){const{state:e,props:t}=this;return s.createElement("div",{className:r("ev-map-menu-image",{"ev-modal-open":t.isModalOpen}),style:{height:e._contentHeight,maxWidth:t.menuScrollableContainerMaxWidth}},s.createElement("div",{ref:e=>this._scrollable=e},s.createElement("div",{className:"ev-map-menu-image-container",style:this.getScrollableStyle()},s.createElement(l,{ref:e=>this._graphic=e,graphicSrc:t.graphic,onLoad:this.setImageWidth,altText:t.alt}),this.props.children,s.createElement("div",{className:"ev-map-menu-image-overlay"}))))}});e.exports=m}).call(this,n(27))},2176:function(e,t,n){"use strict";const i=n(8),o=n(2),s=n(1),r=n(0),{Motion:a,spring:l}=n(1408),m=n(7),{connect:c}=n(6),u=n(96),p=o({displayName:"MapMenuPointer",propTypes:{item:s.object.isRequired,defaultPointerImage:s.object,defaultPointerWidth:s.number,onClick:s.func.isRequired,isModalOpen:s.bool.isRequired},getInitialState:()=>({_isHovering:!1}),onMouseEnter(){const{isModalOpen:e}=this.props;e||this.setState({_isHovering:!0})},onMouseLeave(){this.setState({_isHovering:!1})},onClick(e){const{props:t}=this;e.preventDefault(),t.isModalOpen||t.onClick(t.item)},getPointerImage(){var e;const{props:t}=this;return(null===(e=t.item._mapMenu)||void 0===e?void 0:e._pointerImage)||t.defaultPointerImage},getPointerImageStyle(){const{props:e}=this,t={},n=e.item._mapMenu._pointerWidth||e.defaultPointerWidth;return n&&(t.width=n+"px",t.maxWidth="none"),t},getStyle({scale:e,opacity:t}){const{props:n}=this,o=i(n.item,"_mapMenu._position",{_top:50,_left:50});return{top:o._top+"%",left:o._left+"%",transform:`translate(-50%, -50%) scale(${e})`,opacity:t}},getMotionStyle(){const{state:e,props:t}=this,n=t.isModalOpen?.5:1,i=e._isHovering?1.2:1;return{scale:l(i,{stiffness:175,damping:e._isHovering?12:20}),opacity:l(n)}},render(){const{props:e}=this;return r.createElement(a,{defaultStyle:{scale:1,opacity:1},style:this.getMotionStyle()},t=>r.createElement("button",{className:m("ev-map-menu-pointer",{"ev-is-disabled":e.isModalOpen}),style:this.getStyle(t),onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onClick:this.onClick,"aria-label":this.props.item.title},r.createElement(u,{graphicSrc:this.getPointerImage(),style:this.getPointerImageStyle()})))}});e.exports=c((e,t)=>({item:e.contentObjects[t.itemId]}))(p)},2177:function(e,t,n){"use strict";const i=n(2),o=n(1),s=n(0),{Spring:r,config:a,animated:l}=n(75),m=n(173),c=n(29),u=i({displayName:"MapMenuInformation",propTypes:{body:o.string,closeButtonText:o.string.isRequired,onInfoCloseClick:o.func.isRequired},onInfoCloseClick(e){e.currentTarget.blur(),e.preventDefault(),this.props.onInfoCloseClick()},render(){const{props:e}=this;return s.createElement(m,null,s.createElement(r,{native:!0,from:{opacity:0},to:{opacity:1},config:a.default},({opacity:t})=>s.createElement(l.div,{className:"ev-map-menu-information",style:{opacity:t}},s.createElement("button",{className:"ev-map-menu-button ev-map-menu-information-close-button",onClick:this.onInfoCloseClick,"aria-label":e.closeButtonText},s.createElement("i",{className:"ev-icon ev-icon-cross"})),s.createElement("div",{className:"ev-map-menu-information-inner"},s.createElement(c,{className:"ev-map-menu-body",html:e.body,tabIndex:"1"}),s.createElement("div",{className:"ev-map-menu-information-close-button-container"},s.createElement("button",{className:"ev-map-menu-information-close-button-mobile ev-button",onClick:this.onInfoCloseClick},e.closeButtonText))))))}});e.exports=u},2178:function(e,t,n){"use strict";const i=n(2),o=n(1),s=n(0),{Spring:r,config:a,animated:l}=n(75),{MenuItemProgress:m,MenuItemHOC:c,MenuItemLink:u}=n(301),p=n(173),d=n(1391),h=n(76),g=n(30),v=n(62),I=n(29),f=n(40),M=i({displayName:"MapMenuItem",propTypes:{item:o.object.isRequired,closeButtonText:o.string.isRequired,onCloseMenuItemClick:o.func.isRequired,durationIcon:o.string,shouldShowProgressBarsOnMenus:o.bool,pageMenuItemsCount:o.number,pageMenuItemsCompletedCount:o.number,completedChildrenAsPercentage:o.number},onCloseMenuItemClick(e){e.preventDefault(),e.currentTarget.blur(),this.props.onCloseMenuItemClick()},renderTitle(){const e=d(this.props.item);if(e)return s.createElement(h,{id:this.props.item._id+"-title",headingElement:"h"+this.context,displayTitle:e,className:"ev-map-menu-item-title ev-menu-item-title",innerClassName:"ev-map-menu-item-title-inner ev-menu-item-title-inner"})},renderBody(){if(this.props.item.description)return s.createElement(g,{body:this.props.item.description,className:"ev-map-menu-item-body ev-menu-item-body",innerClassName:"ev-map-menu-item-body-inner ev-menu-item-body-inner"})},renderDurationIcon(){const{durationIcon:e}=this.props;if(e)return s.createElement("i",{className:"ev-menu-item-duration-icon ev-icon ev-icon-"+e})},renderElements(e){const{props:t}=this;return v("menuItem",e,{item:t.item})},render(){const{item:e,closeButtonText:t,pageMenuItemsCompletedCount:n,pageMenuItemsCount:i,completedChildrenAsPercentage:o,shouldShowProgressBarsOnMenus:c}=this.props;return s.createElement(p,null,s.createElement(r,{native:!0,from:{opacity:0},to:{opacity:1},config:a.default},({opacity:r})=>s.createElement(l.div,{className:"ev-map-menu-item ev-menu-item ev-collection-item",style:{opacity:r}},s.createElement("button",{className:"ev-map-menu-button ev-map-menu-items-close-button",onClick:this.onCloseMenuItemClick,"aria-label":t},s.createElement("i",{className:"ev-icon ev-icon-cross"})),s.createElement("div",{className:"ev-map-menu-item-inner ev-clearfix"},s.createElement("div",{className:"ev-map-menu-item-content-container ev-collection-item-content-inner"},this.renderTitle(),this.renderBody(),s.createElement("div",{className:"ev-map-menu-item-duration ev-menu-item-duration"},s.createElement("div",{className:"ev-map-menu-item-duration-inner ev-menu-item-duration-inner"},this.renderDurationIcon(),s.createElement("span",{className:"ev-menu-item-duration-label"},e.durationLabel),s.createElement(I,{element:"span",html:e.duration}))),this.renderElements("content"),c&&s.createElement(m,{item:e,pageMenuItemsCompletedCount:n,pageMenuItemsCount:i,completedChildrenAsPercentage:o})),s.createElement("div",{className:"ev-map-menu-item-buttons ev-collection-item-footer"},s.createElement("div",{className:"ev-collection-item-footer-inner"},s.createElement(u,{isLocked:e._isLocked,isVisited:e._isVisited,linkText:e.linkText,linkIcon:e.linkIcon,isLinkIconRightPosition:e.isLinkIconRightPosition,link:`/${e._type}/${e._id}`}),s.createElement("button",{className:"ev-map-menu-item-close-button-mobile ev-button",onClick:this.onCloseMenuItemClick},t)))))))}});M.contextType=f,e.exports=c(M)}}]);